{"version":3,"sources":["api/Video/Video.controller.js"],"names":["allVideos","deleteVideo","addNewVideo","updateGallery","respondWithResult","res","statusCode","entity","status","json","handleError","err","send","req","params","serviceId","find","service_id","_id","__v","sort","date","exec","then","catch","videoId","remove","id","DeleteVideo","result","n","next","request","body","video_url","title","description","sex","findOne","findService","VideoNewAdd","Date","toISOString","save","InsertService","data","Error","toString","update","image_url","dbpath","UpdateVideo","nModified"],"mappings":"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","file":"Video.controller.js","sourcesContent":["import Video from './Video.model';\r\nimport Service from '../Service/Service.model';\r\nimport {errorJsonResponse, getGuid} from '../../config/commonHelper';\r\n\r\nfunction respondWithResult(res, statusCode) {\r\n    statusCode = statusCode || 200;\r\n    return function (entity) {\r\n        if (entity) {\r\n            return res.status(statusCode).json(entity);\r\n        }\r\n        return null;\r\n    };\r\n}\r\n\r\nfunction handleError(res, statusCode) {\r\n    statusCode = statusCode || 500;\r\n    return function (err) {\r\n        res.status(statusCode).send(err);\r\n    };\r\n}\r\n\r\n// Gets all the Videos\r\nexport function allVideos(req, res) {\r\n    if (req.params.serviceId) {\r\n        return Video.find({service_id: req.params.serviceId}, {_id: 0, __v: 0}).sort({date: -1}).exec()\r\n            .then(respondWithResult(res, 200))\r\n            .catch(handleError(res));\r\n    }\r\n}\r\n\r\n\r\nexport function deleteVideo(req, res) {\r\n    if (req.params.videoId) {\r\n        let videoId = req.params.videoId;\r\n        Video.remove({id: videoId})\r\n            .exec(function (err, DeleteVideo) {\r\n                if (!err) {\r\n                    if (DeleteVideo) {\r\n                        if (DeleteVideo.result.n === 1) {\r\n                            res.status(200)\r\n                                .json({id: videoId, result: \"Deleted Successfully\"});\r\n                        } else {\r\n                            res.status(400)\r\n                                .json(errorJsonResponse(\"Deleted Fail\", \"Deleted Fail\"));\r\n                        }\r\n\r\n                    } else {\r\n                        res.status(400)\r\n                            .json(errorJsonResponse(\"Invalid Post\", \"Invalid Post\"));\r\n                    }\r\n                } else {\r\n                    res.status(400)\r\n                        .json(errorJsonResponse(err, \"Contact to your Developer\"));\r\n                }\r\n            });\r\n    } else {\r\n        res.status(400)\r\n            .json(errorJsonResponse(\"Id is required\", \"Id is required\"));\r\n    }\r\n}\r\n\r\nexport function addNewVideo(req, res, next) {\r\n    try {\r\n\r\n        let request = {\r\n            service_id: req.body.service_id,\r\n            video_url: req.body.video_url,\r\n            title: req.body.title,\r\n            description: req.body.description,\r\n            sex: req.body.sex\r\n        };\r\n\r\n        Service.findOne({id: request.service_id}).exec(function (err, findService) {\r\n            if (findService) {\r\n                let VideoNewAdd = new Video({\r\n                    id: getGuid(),\r\n                    service_id: request.service_id,\r\n                    video_url: request.video_url,\r\n                    title: request.title,\r\n                    description: request.description,\r\n                    date: new Date().toISOString(),\r\n                    sex: request.sex\r\n                });\r\n                VideoNewAdd.save()\r\n                    .then(function (InsertService, err) {\r\n                        if (!err) {\r\n                            if (InsertService) {\r\n                                res.status(200)\r\n                                    .json({\r\n                                        data: InsertService,\r\n                                        result: \"Save Successfully\"\r\n                                    });\r\n                            } else {\r\n                                res.status(400)\r\n                                    .json(errorJsonResponse(\"Error in db response\", \"Invalid_Image\"));\r\n                            }\r\n                        } else {\r\n                            res.status(400)\r\n                                .json(errorJsonResponse(err, \"Contact to your Developer\"));\r\n                        }\r\n                    });\r\n            }\r\n            else {\r\n                res.status(400)\r\n                    .json(errorJsonResponse(\"Service Not Found \", \"Service Not Found\"));\r\n            }\r\n        });\r\n    }\r\n    catch (Error) {\r\n        res.status(400).json(errorJsonResponse(Error.toString(), Error.toString()));\r\n    }\r\n}\r\n\r\nexport function updateGallery(req, res, next) {\r\n    try {\r\n\r\n        let request = {\r\n            id: req.body.id,\r\n            service_id: req.body.service_id,\r\n            video_url: req.body.video_url,\r\n            title: req.body.title,\r\n            description: req.body.description,\r\n            sex: req.body.sex\r\n        };\r\n\r\n        Service.findOne({id: request.service_id}).exec(function (err, findService) {\r\n            if (findService) {\r\n                Video.update({id: request.id}, {\r\n                    service_id: request.service_id,\r\n                    image_url: request.dbpath,\r\n                    title: request.title,\r\n                    description: request.description,\r\n                    date: new Date().toISOString(),\r\n                    sex: request.sex\r\n                }).exec(function (err, UpdateVideo) {\r\n                    if (!err) {\r\n                        if (UpdateVideo) {\r\n                            if (UpdateVideo.nModified === 1 || UpdateVideo.n === 1) {\r\n\r\n                                res.status(200)\r\n                                    .json({\r\n                                        data: request,\r\n                                        result: \"updated Successfully \"\r\n                                    });\r\n\r\n                            } else {\r\n                                res.status(400)\r\n                                    .json(errorJsonResponse(\"Record not found\", \"Record not found\"));\r\n                            }\r\n\r\n                        } else {\r\n                            res.status(400)\r\n                                .json(errorJsonResponse(err, \"Contact to your Developer\"));\r\n                        }\r\n                    } else {\r\n                        res.status(400)\r\n                            .json(errorJsonResponse(err, \"Contact to your Developer\"));\r\n                    }\r\n                });\r\n\r\n            } else {\r\n                res.status(400)\r\n                    .json(errorJsonResponse(\"Service Not Found \", \"Service Not Found\"));\r\n            }\r\n        });\r\n    }\r\n    catch (Error) {\r\n        res.status(400).json(errorJsonResponse(Error.toString(), Error.toString()));\r\n    }\r\n}\r\n"]}