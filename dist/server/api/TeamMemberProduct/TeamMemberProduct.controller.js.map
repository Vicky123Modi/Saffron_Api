{"version":3,"sources":["api/TeamMemberProduct/TeamMemberProduct.controller.js"],"names":["addTeamProduct","removeTeamProduct","teamMemberProductsList","respondWithResult","res","statusCode","entity","status","json","handleError","err","send","req","next","body","id","product_id","TeamObject","find","exec","findProduct","length","TeamMemberProductAdd","teamMember_id","approxTime","save","then","InsertTeamMemberProductAdd","data","result","error","Error","toString","findService","remove","DeleteTeamMember","n","params","teamMemberId","listTeamMemberProduct","productList","forEach","teamMemberProduct","push","$in","product"],"mappings":"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","file":"TeamMemberProduct.controller.js","sourcesContent":["import {applyPatch} from 'fast-json-patch';\r\nimport TeamMemberProduct from './TeamMemberProduct.model';\r\nimport {errorJsonResponse, getGuid} from '../../config/commonHelper';\r\nimport Product from '../Product/Product.model';\r\n\r\nfunction respondWithResult(res, statusCode) {\r\n    statusCode = statusCode || 200;\r\n    return function (entity) {\r\n        if (entity) {\r\n            return res.status(statusCode)\r\n                .json(entity);\r\n        }\r\n        return null;\r\n    };\r\n}\r\n\r\nfunction handleError(res, statusCode) {\r\n    statusCode = statusCode || 500;\r\n    return function (err) {\r\n        res.status(statusCode)\r\n            .send(err);\r\n    };\r\n}\r\n\r\nexport function addTeamProduct(req, res, next) {\r\n    try {\r\n        if (req.body) {\r\n\r\n            let id = req.body.id;\r\n            let product_id = req.body.product_id;\r\n            let TeamObject = {\r\n                id,\r\n                product_id\r\n            };\r\n\r\n            try {\r\n                Product.find({id: product_id}).exec(function (err, findProduct) {\r\n                    if (findProduct.length > 0) {\r\n                        let TeamMemberProductAdd = new TeamMemberProduct({\r\n                            id: getGuid(),\r\n                            teamMember_id: TeamObject.id,\r\n                            product_id: TeamObject.product_id,\r\n                            approxTime: 5,\r\n                        });\r\n                        TeamMemberProductAdd.save()\r\n                            .then(function (InsertTeamMemberProductAdd, err) {\r\n                                if (!err) {\r\n                                    if (InsertTeamMemberProductAdd) {\r\n                                        res.status(200)\r\n                                            .json({\r\n                                                data: InsertTeamMemberProductAdd,\r\n                                                result: \"Successfully Add new product\"\r\n                                            });\r\n                                    } else {\r\n                                        res.status(400)\r\n                                            .json(errorJsonResponse(\"Error in db response\", \"Invalid_Image\"));\r\n                                    }\r\n                                } else {\r\n                                    res.status(400)\r\n                                        .json(errorJsonResponse(err, \"Contact to your Developer\"));\r\n                                }\r\n                            });\r\n                    }\r\n                    else {\r\n                        res.status(400).json(errorJsonResponse(\"Product is not found\", \"Product is not found\"));\r\n                    }\r\n                });\r\n            }\r\n            catch\r\n                (error) {\r\n                res.status(400).json(errorJsonResponse(error, \"contact to developer\"))\r\n            }\r\n        }\r\n    }\r\n    catch (Error) {\r\n        res.status(400).json(errorJsonResponse(Error.toString(), \"Invalid Request\"));\r\n    }\r\n}\r\n\r\nexport function removeTeamProduct(req, res, next) {\r\n    try {\r\n        if (req.body) {\r\n\r\n            let id = req.body.id;\r\n            let product_id = req.body.product_id;\r\n            let TeamObject = {\r\n                id,\r\n                product_id\r\n            };\r\n\r\n            try {\r\n                Product.find({id: product_id}).exec(function (err, findService) {\r\n                    if (findService.length > 0) {\r\n                        TeamMemberProduct.remove({teamMember_id: TeamObject.id, product_id: TeamObject.product_id})\r\n                            .exec(function (err, DeleteTeamMember) {\r\n                                if (!err) {\r\n                                    if (DeleteTeamMember) {\r\n                                        if (DeleteTeamMember.result.n === 1) {\r\n                                            res.status(200)\r\n                                                .json({\r\n                                                    data: TeamObject,\r\n                                                    result: \"Successfully Remove Product\"\r\n                                                });\r\n                                        } else {\r\n                                            res.status(400)\r\n                                                .json(errorJsonResponse(\"service not found\", \"service not found\"));\r\n                                        }\r\n                                    }\r\n                                }\r\n                            });\r\n                    }\r\n                    else {\r\n                        res.status(403).json(errorJsonResponse(\"Product is not found\", \"Product is not found\"));\r\n                    }\r\n                });\r\n            }\r\n            catch\r\n                (error) {\r\n                res.status(501).json(errorJsonResponse(error, \"contact to developer\"))\r\n            }\r\n        }\r\n    }\r\n    catch (Error) {\r\n        res.status(400).json(errorJsonResponse(Error.toString(), \"Invalid Request\"));\r\n    }\r\n}\r\n\r\nexport function teamMemberProductsList(req, res, next) {\r\n    try {\r\n        if (req.params.teamMemberId) {\r\n            let teamMemberId = req.params.teamMemberId;\r\n\r\n            TeamMemberProduct.find({teamMember_id: teamMemberId}).exec((err, listTeamMemberProduct) => {\r\n                if (!err) {\r\n                    let productList = [];\r\n                    listTeamMemberProduct.forEach((teamMemberProduct) => {\r\n                        productList.push(teamMemberProduct.product_id);\r\n                    });\r\n\r\n                    return Product.find({\r\n                        id: {\r\n                            $in: productList\r\n                        }\r\n                    }).exec(function (err, product) {\r\n                        res.status(200).json(product);\r\n                    })\r\n                } else {\r\n                    res.status(400)\r\n                        .json(errorJsonResponse(err, \"Contact to your Developer\"));\r\n                }\r\n            });\r\n        } else {\r\n            res.status(400)\r\n                .json(errorJsonResponse(\"Team Member Id is required\", \"Team Member Id is required\"));\r\n        }\r\n    } catch (error) {\r\n        res.status(400).json(errorJsonResponse(error, \"Contact to your Developer\"));\r\n    }\r\n}\r\n"]}